

<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="lang:clipboard.copy" content="Copy to clipboard">
  <meta name="lang:clipboard.copied" content="Copied to clipboard">
  <meta name="lang:search.language" content="en">
  <meta name="lang:search.pipeline.stopwords" content="True">
  <meta name="lang:search.pipeline.trimmer" content="True">
  <meta name="lang:search.result.none" content="No matching documents">
  <meta name="lang:search.result.one" content="1 matching document">
  <meta name="lang:search.result.other" content="# matching documents">
  <meta name="lang:search.tokenizer" content="[\s\-]+">

  
    <link href="https://fonts.gstatic.com/" rel="preconnect" crossorigin>
    <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700|Roboto:300,400,400i,700&display=fallback" rel="stylesheet">

    <style>
      body,
      input {
        font-family: "Roboto", "Helvetica Neue", Helvetica, Arial, sans-serif
      }

      code,
      kbd,
      pre {
        font-family: "Roboto Mono", "Courier New", Courier, monospace
      }
    </style>
  

  <link rel="stylesheet" href="_static/stylesheets/application.css"/>
  <link rel="stylesheet" href="_static/stylesheets/application-palette.css"/>
  <link rel="stylesheet" href="_static/stylesheets/application-fixes.css"/>
  
  <link rel="stylesheet" href="_static/fonts/material-icons.css"/>
  
  <meta name="theme-color" content="#3f51b5">
  <script src="_static/javascripts/modernizr.js"></script>
  
  
  
    <title>Rigid transformations, coordinates and reference frames &#8212; Kinetics Toolkit master documentation</title>
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/material.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/css/custom.css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Saving and loading" href="loadsave.html" />
    <link rel="prev" title="Detecting and normalizing cycles" href="cycles.html" />



  
   

  </head>
  <body dir=ltr
        data-md-color-primary=white data-md-color-accent=orange>
  
  <svg class="md-svg">
    <defs data-children-count="0">
      
      <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
      
    </defs>
  </svg>
  
  <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer">
  <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search">
  <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
  <a href="#geometry" tabindex="1" class="md-skip"> Skip to content </a>
  <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex navheader">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="index.html" title="Kinetics Toolkit master documentation"
           class="md-header-nav__button md-logo">
          
              <img src="_static/logo.png" height="26"
                   alt="Kinetics Toolkit master documentation logo">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          <span class="md-header-nav__topic">Kinetics Toolkit</span>
          <span class="md-header-nav__topic"> Rigid transformations, coordinates and reference frames </span>
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
        
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" action="search.html" method="GET" name="search">
      <input type="text" class="md-search__input" name="q" placeholder="Search"
             autocapitalize="off" autocomplete="off" spellcheck="false"
             data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>

      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            <a href="https://github.com/felixchenier/kineticstoolkit/" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    kineticstoolkit
  </div>
</a>
          </div>
        </div>
      
      
  
  <script src="_static/javascripts/version_dropdown.js"></script>
  <script>
    var json_loc = ""versions.json"",
        target_loc = "../",
        text = "Versions";
    $( document ).ready( add_version_dropdown(json_loc, target_loc, text));
  </script>
  

    </div>
  </nav>
</header>

  
  <div class="md-container">
    
    
    
    <main class="md-main">
      <div class="md-main__inner md-grid" data-md-component="container">
        
          <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="index.html" title="Kinetics Toolkit master documentation" class="md-nav__button md-logo">
      
        <img src="_static/logo.png" alt=" logo" width="48" height="48">
      
    </a>
    <a href="index.html"
       title="Kinetics Toolkit master documentation">Kinetics Toolkit</a>
  </label>
    <div class="md-nav__source">
      <a href="https://github.com/felixchenier/kineticstoolkit/" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    kineticstoolkit
  </div>
</a>
    </div>
  
  

  
  <ul class="md-nav__list">
    <li class="md-nav__item">
    
      <span class="md-nav__link caption"><span class="caption-text">THE BASICS</span></span>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="install.html" class="md-nav__link">Installing Kinetics Toolkit</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="timeseries.html" class="md-nav__link">Getting started with TimeSeries</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="filters.html" class="md-nav__link">Filtering TimeSeries</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="cycles.html" class="md-nav__link">Detecting and normalizing cycles</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    <label class="md-nav__link md-nav__link--active" for="__toc"> Rigid transformations, coordinates and reference frames </label>
    
      <a href="#" class="md-nav__link md-nav__link--active">Rigid transformations, coordinates and reference frames</a>
      
        
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">Contents</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#geometry--page-root" class="md-nav__link">Rigid transformations, coordinates and reference frames</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#Dimension-convention" class="md-nav__link">Dimension convention</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#Series-of-scalars" class="md-nav__link">Series of scalars</a>
        </li>
        <li class="md-nav__item"><a href="#Series-of-vectors-and-points" class="md-nav__link">Series of vectors and points</a>
        </li>
        <li class="md-nav__item"><a href="#Series-of-groups-of-vectors-or-points" class="md-nav__link">Series of groups of vectors or points</a>
        </li>
        <li class="md-nav__item"><a href="#Series-of-transformation-matrices" class="md-nav__link">Series of transformation matrices</a>
        </li>
        <li class="md-nav__item"><a href="#Working-with-constants" class="md-nav__link">Working with constants</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#Matrix-multiplication" class="md-nav__link">Matrix multiplication</a>
        </li>
        <li class="md-nav__item"><a href="#Series-of-rotations" class="md-nav__link">Series of rotations</a>
        </li>
        <li class="md-nav__item"><a href="#Series-of-reference-frames" class="md-nav__link">Series of reference frames</a>
        </li>
        <li class="md-nav__item"><a href="#Calculating-local-and-global-coordinates" class="md-nav__link">Calculating local and global coordinates</a>
        </li></ul>
            </nav>
        </li>
  </ul>
</nav>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="loadsave.html" class="md-nav__link">Saving and loading</a>
      
    
    </li>
    <li class="md-nav__item">
    
      <span class="md-nav__link caption"><span class="caption-text">INTEGRATED BIOMECHANICAL ANALYSES</span></span>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="kinematics.html" class="md-nav__link">Kinematics analysis</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="pushrimkinetics.html" class="md-nav__link">Wheelchair kinetics</a>
      
    
    </li>
    <li class="md-nav__item">
    
      <span class="md-nav__link caption"><span class="caption-text">MORE IN DEPTH</span></span>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="labmode.html" class="md-nav__link">Lab mode</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="release_notes.html" class="md-nav__link">Release Notes</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="api_reference.html" class="md-nav__link">API Reference</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="https://felixchenier.uqam.ca/kineticstoolkit" class="md-nav__link">Stable version</a>
      
    
    </li>
    <li class="md-nav__item">
    
      <span class="md-nav__link caption"><span class="caption-text">IN DEVELOPMENT</span></span>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="inversedynamics.html" class="md-nav__link">Inverse Dynamics</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="dbinterface.html" class="md-nav__link">DBInterface</a>
      
    
    </li>
  </ul>
  

</nav>
              </div>
            </div>
          </div>
          <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">Contents</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#geometry--page-root" class="md-nav__link">Rigid transformations, coordinates and reference frames</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#Dimension-convention" class="md-nav__link">Dimension convention</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#Series-of-scalars" class="md-nav__link">Series of scalars</a>
        </li>
        <li class="md-nav__item"><a href="#Series-of-vectors-and-points" class="md-nav__link">Series of vectors and points</a>
        </li>
        <li class="md-nav__item"><a href="#Series-of-groups-of-vectors-or-points" class="md-nav__link">Series of groups of vectors or points</a>
        </li>
        <li class="md-nav__item"><a href="#Series-of-transformation-matrices" class="md-nav__link">Series of transformation matrices</a>
        </li>
        <li class="md-nav__item"><a href="#Working-with-constants" class="md-nav__link">Working with constants</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#Matrix-multiplication" class="md-nav__link">Matrix multiplication</a>
        </li>
        <li class="md-nav__item"><a href="#Series-of-rotations" class="md-nav__link">Series of rotations</a>
        </li>
        <li class="md-nav__item"><a href="#Series-of-reference-frames" class="md-nav__link">Series of reference frames</a>
        </li>
        <li class="md-nav__item"><a href="#Calculating-local-and-global-coordinates" class="md-nav__link">Calculating local and global coordinates</a>
        </li></ul>
            </nav>
        </li>
  </ul>
</nav>
              </div>
            </div>
          </div>
        
        <div class="md-content">
          <article class="md-content__inner md-typeset" role="main">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
</style>

<h1 id="geometry--page-root">Rigid transformations, coordinates and reference frames<a class="headerlink" href="#geometry--page-root" title="Permalink to this headline">¶</a></h1>
<p>The <a class="reference internal" href="api/kineticstoolkit.geometry.html"><span class="doc">geometry</span></a> module simplifies the calculation of linear algebric operations on series of points, vectors and transformation matrices. Contrarily to most other modules, this module does not work with TimeSeries directly, but instead with the TimeSeries data. The convention for dimension order is strict but well defined.</p>

<h2 id="Dimension-convention">Dimension convention<a class="headerlink" href="#Dimension-convention" title="Permalink to this headline">¶</a></h2>
<p>In this module, every point, vector or matrix is considered as a <strong>series</strong>, even constants which are series of 1. The dimensions of these series are:</p>
<ul class="simple">
<li><p>Dimension 0 = time (length of m). Constants are expressed as series with m = 1 and are broadcasted to match other series with m &gt; 1.</p></li>
<li><p>Dimension 1 (optional) = axis or row (length of 4).</p></li>
<li><p>Dimension 2 (optional) = point/vector index or column (length of n).</p></li>
</ul>
<p>To understand better how to express series of scalars, vectors, points, sets and matrices, please refer to the following pictures:</p>

<h3 id="Series-of-scalars">Series of scalars<a class="headerlink" href="#Series-of-scalars" title="Permalink to this headline">¶</a></h3>
<a class="reference internal image-reference" href="_images/series_of_m_scalars.png"><img alt="Series of m scalars" src="_images/series_of_m_scalars.png" style="width: 400px;"/></a>


<h3 id="Series-of-vectors-and-points">Series of vectors and points<a class="headerlink" href="#Series-of-vectors-and-points" title="Permalink to this headline">¶</a></h3>
<p><a class="reference internal" href="_images/series_of_m_vectors.png"><img alt="Series of m vectors" src="_images/series_of_m_vectors.png" style="width: 400px;"/></a> <a class="reference internal" href="_images/series_of_m_points.png"><img alt="Series of m points" src="_images/series_of_m_points.png" style="width: 400px;"/></a></p>
<p>Note the difference between vectors and points: vectors (e.g., forces, velocities) have zeros as their fourth coordinate while points (e.g., marker coordinates) have ones. This difference has an impact on algeabric calculation:</p>
<ul class="simple">
<li><p>A rigid transformation of a vector gives a new rotated vector expressed as a new orientation and amplitude.</p></li>
<li><p>A rigid transformation on a point yields a translated point expressed as its new coordinates in the new reference frame.</p></li>
</ul>


<h3 id="Series-of-groups-of-vectors-or-points">Series of groups of vectors or points<a class="headerlink" href="#Series-of-groups-of-vectors-or-points" title="Permalink to this headline">¶</a></h3>
<p><a class="reference internal" href="_images/series_of_m_groups_of_n_vectors.png"><img alt="Series of m groups of n vectors" src="_images/series_of_m_groups_of_n_vectors.png" style="width: 400px;"/></a> <a class="reference internal" href="_images/series_of_m_groups_of_n_points.png"><img alt="Series of m groups of n points" src="_images/series_of_m_groups_of_n_points.png" style="width: 400px;"/></a></p>


<h3 id="Series-of-transformation-matrices">Series of transformation matrices<a class="headerlink" href="#Series-of-transformation-matrices" title="Permalink to this headline">¶</a></h3>
<a class="reference internal image-reference" href="_images/series_of_m_transformation_matrices.png"><img alt="Series of m transformation matrices" src="_images/series_of_m_transformation_matrices.png" style="width: 500px;"/></a>


<h3 id="Working-with-constants">Working with constants<a class="headerlink" href="#Working-with-constants" title="Permalink to this headline">¶</a></h3>
<p>Since everything in the <code class="docutils literal notranslate"><span class="pre">geometry</span></code> module is considered as a series, always ensure that the first dimension of any array is reserved to time. For example, the vector (x = 1, y = 2, z = 3) must be expressed as <code class="docutils literal notranslate"><span class="pre">np.array([[1.0,</span> <span class="pre">2.0,</span> <span class="pre">3.0,</span> <span class="pre">0.0]])</span></code> (note the double brackets). A common error would be to express it as <code class="docutils literal notranslate"><span class="pre">np.array([1.0,</span> <span class="pre">2.0,</span> <span class="pre">3.0,</span> <span class="pre">0.0])</span></code> (single brackets), which would mean a series of 4 floats instead of one constant vector.</p>
<p>A quick way to convert a constant array to a series is to use numpy’s <code class="docutils literal notranslate"><span class="pre">newaxis</span></code>:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">kineticstoolkit.lab</span> <span class="k">as</span> <span class="nn">ktk</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">one_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">one_matrix</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([[1., 0., 0., 0.],
       [0., 1., 0., 0.],
       [0., 0., 1., 0.],
       [0., 0., 0., 1.]])
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">series_of_one_matrix</span> <span class="o">=</span> <span class="n">one_matrix</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>
<span class="n">series_of_one_matrix</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([[[1., 0., 0., 0.],
        [0., 1., 0., 0.],
        [0., 0., 1., 0.],
        [0., 0., 0., 1.]]])
</pre></div></div>
</div>



<h2 id="Matrix-multiplication">Matrix multiplication<a class="headerlink" href="#Matrix-multiplication" title="Permalink to this headline">¶</a></h2>
<p>To facilitate the multiplication of series, kineticstoolkit.geometry provides a <code class="docutils literal notranslate"><span class="pre">matmul</span></code> function that matches both matrices’ time dimensions before applying the numpy’s @ or * operator accordingly on each time iteration. Therefore, when dealing with series of floats, vectors, points or matrices, it is advisable to use kineticstoolkit.geometry’s <code class="docutils literal notranslate"><span class="pre">matmul</span></code> instead of the @ operator, which will garranty to follow Kinetics Toolkit’s array convention. For example among others:</p>
<p><strong>Matrix multiplication between a matrix and a series of points</strong></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># A single rigid transformation matrix that translates 3 units in x</span>
<span class="n">T</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">3.</span><span class="p">],</span>
               <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
               <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
               <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]]])</span>

<span class="c1"># times a series of 5 points</span>
<span class="n">points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">],</span>
                   <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">],</span>
                   <span class="p">[</span><span class="mf">2.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">],</span>
                   <span class="p">[</span><span class="mf">3.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">],</span>
                   <span class="p">[</span><span class="mf">4.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]])</span>

<span class="n">ktk</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">points</span><span class="p">)</span>  <span class="c1"># gives a series of 5 points</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([[3., 1., 0., 1.],
       [4., 1., 0., 1.],
       [5., 1., 0., 1.],
       [6., 1., 0., 1.],
       [7., 1., 0., 1.]])
</pre></div></div>
</div>
<p><strong>Multiplication between a series of floats and a series of vectors</strong></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># A series of 5 floats</span>
<span class="n">floats</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">])</span>

<span class="c1"># times a series of 5 vectors</span>
<span class="n">vectors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                    <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                    <span class="p">[</span><span class="mf">2.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                    <span class="p">[</span><span class="mf">3.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                    <span class="p">[</span><span class="mf">4.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]])</span>

<span class="n">ktk</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">floats</span><span class="p">,</span> <span class="n">vectors</span><span class="p">)</span>  <span class="c1"># gives a series of 5 vectors</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([[0. , 0. , 0. , 0. ],
       [0.5, 0.5, 0. , 0. ],
       [2. , 1. , 0. , 0. ],
       [3. , 1. , 0. , 0. ],
       [4. , 1. , 0. , 0. ]])
</pre></div></div>
</div>


<h2 id="Series-of-rotations">Series of rotations<a class="headerlink" href="#Series-of-rotations" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference internal" href="api/kineticstoolkit.geometry.html"><span class="doc">geometry</span></a> module provides two functions for manipulating series of rotations:</p>
<ul class="simple">
<li><p><a class="reference internal" href="api/kineticstoolkit.geometry.html#kineticstoolkit.geometry.create_rotation_matrices"><span class="std std-ref">create_rotation_matrices</span></a>: A wrapper to <code class="docutils literal notranslate"><span class="pre">scipy.transform.Rotation.from_euler</span></code> that creates Nx4x4 series rigid transformations based on rotation axes and angles.</p></li>
<li><p><a class="reference internal" href="api/kineticstoolkit.geometry.html#kineticstoolkit.geometry.create_rotation_matrices"><span class="std std-ref">get_euler_angles</span></a>: A wrapper to <code class="docutils literal notranslate"><span class="pre">scipy.transform.Rotation.as_euler</span></code> that extracts Euler angles from Nx4x4 series of rigid transformations.</p></li>
</ul>


<h2 id="Series-of-reference-frames">Series of reference frames<a class="headerlink" href="#Series-of-reference-frames" title="Permalink to this headline">¶</a></h2>
<a class="reference internal image-reference" href="_images/humerus_reference_frame.png"><img alt="Right humerus reference frame" src="_images/humerus_reference_frame.png" style="width: 200px;"/></a>
<p>The <a class="reference internal" href="api/kineticstoolkit.geometry.html"><span class="doc">geometry</span></a> module provides the <a class="reference internal" href="api/kineticstoolkit.geometry.html#kineticstoolkit.geometry.create_reference_frames"><span class="std std-ref">create_reference_frames</span></a> function to generate series of reference frames based on marker positions.</p>
<p>In this example, we will create the series of N rigid transformations that corresponds to the 3d position and orientation of the right humerus, based on three markers:</p>
<ul class="simple">
<li><p>GH: the Nx4 trajectory of the gleno-humeral joint;</p></li>
<li><p>EL: the Nx4 trajectory of the lateral elbow epicondyle;</p></li>
<li><p>EM: the Nx4 trajectory of the medial elbow epicondyle.</p></li>
</ul>
<p>We will follow the recommendations of the International Society of Biomechanics [1]:</p>
<ol class="arabic">
<li><p><strong>The origin is GH</strong>;</p>
<p><code class="docutils literal notranslate"><span class="pre">origin</span> <span class="pre">=</span> <span class="pre">GH</span></code></p>
</li>
<li><p><strong>The y axis is the line between GH and the midpoint of EL and EM, pointing to GH</strong>;</p>
<p><code class="docutils literal notranslate"><span class="pre">y</span> <span class="pre">=</span> <span class="pre">GH</span> <span class="pre">-</span> <span class="pre">(EL</span> <span class="pre">+</span> <span class="pre">EM)</span> <span class="pre">/</span> <span class="pre">2</span></code></p>
</li>
<li><p><strong>The x axis is the normal to the GH-EL-EM plane, pointing forward</strong>;</p>
<p>We define the yz plane (in yellow) by a second vector (in yellow) that is in this plane. The x axis will then be generated by the cross product of y and yz.</p>
<p><code class="docutils literal notranslate"><span class="pre">yz</span> <span class="pre">=</span> <span class="pre">EL</span> <span class="pre">-</span> <span class="pre">EM</span></code></p>
</li>
<li><p><strong>The z axis is perpendicular to x and y, pointing to the right</strong>.</p>
<p><code class="docutils literal notranslate"><span class="pre">reference_frames</span> <span class="pre">=</span> <span class="pre">ktk.geometry.create_reference_frames(origin=origin,</span> <span class="pre">y=y,</span> <span class="pre">yz=yz)</span></code></p>
<p>This yields a series of rigid transformation matrices that express the humerus reference frame shown in the figure above.</p>
</li>
</ol>
<p>[1] G. Wu et al., “ISB recommendation on definitions of joint coordinate systems of various joints for the reporting of human joint motion - Part II: shoulder, elbow, wrist and hand,” Journal of Biomechanics, vol. 38, no. 5, pp. 981–992, 2005.</p>


<h2 id="Calculating-local-and-global-coordinates">Calculating local and global coordinates<a class="headerlink" href="#Calculating-local-and-global-coordinates" title="Permalink to this headline">¶</a></h2>
<p>Finally, the <a class="reference internal" href="api/kineticstoolkit.geometry.html"><span class="doc">geometry</span></a> module provides function to change the reference frame used to express points, vectors and matrices from local to global coordinates and vice versa:</p>
<ul class="simple">
<li><p><a class="reference internal" href="api/kineticstoolkit.geometry.html#kineticstoolkit.geometry.get_local_coordinates"><span class="std std-ref">get_local_coordinates</span></a>: Express global coordinates inside a local reference frame;</p></li>
<li><p><a class="reference internal" href="api/kineticstoolkit.geometry.html#kineticstoolkit.geometry.get_global_coordinates"><span class="std std-ref">get_global_coordinates</span></a>: Express local coordinates in global coordinates.</p></li>
</ul>
<p>For more information on geometry, please check the <a class="reference internal" href="api/kineticstoolkit.geometry.html"><span class="doc">API Reference for the geometry module</span></a>.</p>




          </article>
        </div>
      </div>
    </main>
  </div>
  <footer class="md-footer">
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
          
            <a href="cycles.html" title="Detecting and normalizing cycles"
               class="md-flex md-footer-nav__link md-footer-nav__link--prev"
               rel="prev">
              <div class="md-flex__cell md-flex__cell--shrink">
                <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
              </div>
              <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
                <span class="md-flex__ellipsis">
                  <span
                      class="md-footer-nav__direction"> Previous </span> Detecting and normalizing cycles </span>
              </div>
            </a>
          
          
            <a href="loadsave.html" title="Saving and loading"
               class="md-flex md-footer-nav__link md-footer-nav__link--next"
               rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span
                class="md-flex__ellipsis"> <span
                class="md-footer-nav__direction"> Next </span> Saving and loading </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink"><i
                class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          
        </a>
        
      </nav>
    </div>
    <div class="md-footer-meta md-typeset">
      <div class="md-footer-meta__inner md-grid">
        <div class="md-footer-copyright">
          <div class="md-footer-copyright__highlight">
              &#169; Copyright 2020, Félix Chénier.
              
          </div>
            Created using
            <a href="http://www.sphinx-doc.org/">Sphinx</a> 3.4.3.
             and
            <a href="https://github.com/bashtage/sphinx-material/">Material for
              Sphinx</a>
        </div>
      </div>
    </div>
  </footer>
  <script src="_static/javascripts/application.js"></script>
  <script>app.initialize({version: "1.0.4", url: {base: ".."}})</script>
  </body>
</html>